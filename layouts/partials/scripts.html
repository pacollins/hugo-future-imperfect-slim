{{ if .Site.Params.enableCDN }}
  {{ if .Site.Params.highlightjs }}
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
    {{ range .Site.Params.highlightjsLang }}<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/{{ . }}.min.js"></script>{{ end }}
    <script>hljs.initHighlightingOnLoad();</script>
  {{ end }}
  {{ range .Site.Params.jsFiles }}
    {{ if eq . "default" }}
    <script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js"></script>
      {{ $util := resources.Get "js/util.js" }}
      {{ $main := resources.Get "js/main.js" }}
      {{ $jsSlice := slice $util $main }}
      {{ if $.Site.Params.staticman.enabled }}
        {{ $jsSlice = $jsSlice | append (resources.Get "js/staticman.js" | resources.ExecuteAsTemplate "js/staticman.js" $.Site.Params.staticman) }}
      {{ end }}
      {{ $js := $jsSlice | resources.Concat "js/localbundle.js" | resources.Minify | resources.Fingerprint }}
    <script src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.Integrity }}">
    <script src="{{ "js/add-on.js" | relURL }}"></script>
    {{ else }}
      <script src="{{ . | relURL }}"></script>
    {{ end }}
  {{ end }}
{{ else }}
  {{ if .Site.Params.highlightjs }}
    {{ $hljs := resources.Get "js/highlight.pack.js" }}
    <script src="{{ $hljs.RelPermalink }}"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  {{ end }}
  {{ range .Site.Params.jsFiles }}
    {{ if eq . "default" }}
      {{ $jquery := resources.Get "js/jquery-3.4.1.js" }}
      {{ $fancybox := resources.Get "js/fancybox.js" }}
      {{ $util := resources.Get "js/util.js" }}
      {{ $main := resources.Get "js/main.js" }}
      {{ $jsSlice := slice $jquery $fancybox $util $main }}
      {{ if $.Site.Params.staticman.enabled }}
        {{ $jsSlice = $jsSlice | append (resources.Get "js/staticman.js" | resources.ExecuteAsTemplate "js/staticman.js" $.Site.Params.staticman) }}
        }
      {{ end }}
      {{ $js := $jsSlice | resources.Concat "js/bundle.js" | resources.Minify | resources.Fingerprint }}
    <script src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.Integrity }}"></script>
    <script src="{{ "js/add-on.js" | relURL }}"></script>
    {{ else }}
      <script src="{{ . | relURL }}"></script>
    {{ end }}
  {{ end }}
{{ end }}
{{/* Backwards compatibility for deprecated parameter ".Site.Params.staticman.staticman" */}}
{{ if or .Site.Params.staticman.enabled .Site.Params.staticman.staticman }}
  {{- $smjs := resources.Get "js/staticman.js" | resources.ExecuteAsTemplate "js/staticman.js" .Site.Params.staticman -}}
  <script src='{{ $smjs.RelPermalink }}'></script>
  {{ if and .Site.Params.staticman.recaptcha.siteKey .Site.Params.staticman.recaptcha.encryptedKey }}
    <script src='https://www.google.com/recaptcha/api.js'></script>
  {{ end }}
{{ end }}
{{ template "_internal/google_analytics_async.html" . }}
